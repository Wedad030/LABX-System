<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุงุณุชูุงู ุญุงูุฉ ูู ุงูุนุงูู</title>
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg">
    <div class="layout">

        <!-- ุงูููุฏุฑ -->
        <header class="top-header">
            <div class="top-header-right">
                <img src="labx.jpeg" class="logo-img" alt="LABX Dental">
                <div class="brand-text">
                    <div class="brand-title">LABX DENTAL</div>
                    <div class="brand-sub">ุงุณุชูุงู ุญุงูุฉ โ ุงููุนูู</div>
                </div>
            </div>

            <div class="top-header-left">
                <div class="user-info">
                    <span class="hello">๐ ุฃููุงู </span>
                    <span id="username" class="user-name"></span>
                </div>
            </div>
        </header>

        <!-- ุงููุญุชูู -->
        <main class="main-card fade-in">

            <h2>ุงุณุชูุงู ุญุงูุฉ ูู ุงูุนุงูู ุงูููู</h2>

            <label>ุงุฎุชุฑ ุงูุนุงูู:</label>
            <select id="worker" class="input">
                <option value="">โ ุงุฎุชุฑ โ</option>
                <option value="ุดูุงุจ - RDC1">ุดูุงุจ โ RDC1</option>
                <option value="ุฃููู - RDC2">ุฃููู โ RDC2</option>
            </select>

            <label style="margin-top:15px;">ุฑูู ุงูููู:</label>
            <input id="fileNumber" type="text" class="input" placeholder="ุฃุฏุฎู ุฑูู ููู ุงููุฑูุถ">

            <label style="margin-top:15px;">ููุงุญุธุฉ (ุงุฎุชูุงุฑู):</label>
            <textarea id="note" rows="3" class="input" placeholder="ููุงุญุธุงุช ุงูุนุงูู..."></textarea>

            <button onclick="receiveCase()" class="btn-logout" 
                style="background:#163a43;margin-top:20px;">ุชุฃููุฏ ุงุณุชูุงู ุงูุญุงูุฉ</button>

            <a href="index.html" class="btn-logout" 
                style="background:#f7666e;text-decoration:none;margin-top:10px;">ุฑุฌูุน ูููุงุฌูุฉ</a>
        </main>
    </div>

    <script>
        // ุญูุธ ุงุณู ุงููุณุชุฎุฏู
        document.getElementById("username").innerText = localStorage.getItem("labxUser") || "User";

        // ุฏุงูุฉ ุงุณุชูุงู ุงูุญุงูุฉ
        function receiveCase() {
            const worker = document.getElementById("worker").value;
            const file = document.getElementById("fileNumber").value.trim();
            const note = document.getElementById("note").value.trim();

            if (!worker || !file) {
                alert("โ๏ธ ูุฑุฌู ุชุนุจุฆุฉ ูู ุงูุญููู ุงูุฃุณุงุณูุฉ.");
                return;
            }

            // ุณุญุจ ุงูุญุงูุงุช ุงูุญุงููุฉ
            let cases = JSON.parse(localStorage.getItem("labxNewCases")) || [];

            // ุชุญุฏูุซ ุงูุญุงูุฉ ุฏุงุฎู ุงููุงุฆูุฉ
            const index = cases.findIndex(c => c.fileNumber === file);

            if (index === -1) {
                alert("โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุญุงูุฉ ุจูุฐุง ุงูุฑูู.");
                return;
            }

            cases[index].receivedByWorker = worker;
            cases[index].receivedTime = new Date().toLocaleString();
            cases[index].noteFromWorker = note;
            cases[index].status = "ูุตูุช ูููุนูู";

            localStorage.setItem("labxNewCases", JSON.stringify(cases));

            alert("โ ุชู ุงุณุชูุงู ุงูุญุงูุฉ ูู ุงูุนุงูู ุจูุฌุงุญ!");
            location.reload();
        }
    </script>

</body>
</html>
